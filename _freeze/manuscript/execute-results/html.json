{
  "hash": "a398b43e1374951b55a9db09653d70d6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Investigating the bioremediation potential of seaweed aquaculture across Australia\ndate: last-modified\nbibliography: [resources/refs.bib, resources/manual-refs.bib]\n\nformat:\n  html:\n    theme: simplex\n    css: [resources/extra.css]\n    code-fold: true\n    code-overflow: wrap\n    toc: true\n    toc-expand: true\n    toc-location: left\n    toc-depth: 4\n    lang: en-GB\n    grid:\n      sidebar-width: 400px\n      body-width: 1200px\n      margin-width: 100px\n      gutter-width: 2em\n        \nexecute:\n  eval: false\n  cache: true\n  fig-height: 6\n  fig-width: 4\n  freeze: auto\n\nknitr: \n  opts_chunk:\n    fig.align: center\n    fig.width: 6\n---\n\n::: {.cell .hidden layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# You need quarto to generate this markdown - install here: https://quarto.org/docs/get-started/\n# This markdown uses the acronyms extension - install by entering quarto add rchaput/acronyms@master into the terminal\n# This markdown uses TinyTex for PDF rendering - install with tinytex::install_tinytex()\n\nlibrary(stringr)\nlibrary(units)\nlibrary(targets)\nlibrary(tarchetypes)\nlibrary(macrogrow)\nlibrary(ozmaps)\nlibrary(arrow)\nlibrary(gganimate)\nlibrary(magrittr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(lubridate)\nlibrary(tidyr)\nlibrary(conflicted)\nconflicts_prefer(dplyr::select(), dplyr::filter(), .quiet = T)\n```\n:::\n\n::: {.cell .hidden layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# source(file.path(base_path, \"R\", \"other-functions.R\"))\nspec_store <- file.path(\"targets_outputs\", \"_species\")\nspec_data <- file.path(\"data\", \"processed_species\")\ncell_data <- file.path(\"data\", \"processed_cell_data\")\nruns_data <- file.path(\"data\", \"processed_model_running\")\n\nbounds <- tar_read(states_bbox, store = file.path(\"targets_outputs\", \"_model_running_TAS\"))\n\nprettyplot <- theme_classic() +\n  theme(text = element_text(family = \"sans\", size = 12, colour = \"black\"),\n        axis.title = element_text(vjust = 2),\n        legend.position = \"none\")\n\nenv_plot <- prettyplot +\n  theme(legend.position = \"none\",\n        aspect.ratio = 0.55,\n        text = element_text(family = \"sans\", size = 11, colour = \"black\"))\n\nnitrogen_lab <- expression(\"Concentration (\"*mu*\"M N)\")\nnitrate_lab <- expression(\"Nitrate concentration (\"*mu*\"M NO\"[3]*\")\")\nammonium_lab <- expression(\"Ammonium concentration (\"*mu*\"M NH\"[4]^+\")\")\n\n# Allows using \"units\" package to convert between moles and g of nitrogen ONLY\nremove_unit(\"mol\")\ninstall_unit(\"mol\", \"14.0067 g\")\n\nprettynum <- function(num, sigfig=2) {format(round(as.numeric(num), sigfig), nsmall=1, big.mark=\",\")}\n\nspecies_pal <- c(\"red3\", \"dodgerblue3\")\ndepths_pal <- c(\"green3\", \"#FF8247\", \"dodgerblue3\", \"#292928\")\nstates_pal <- c(\"#d95f02\", \"#e6ab02\", \"#7570b3\", \"#1b9e77\", \"#66a61e\", \"#e7298a\", \"#a6761d\", \"#666666\")\nscens_pal_1 <- c(\"#292928\", \"dodgerblue3\", \"#66a61e\", \"#e7298a\", \"#e6ab02\")\nscens_pal_2 <- c(\"dodgerblue3\", \"#66a61e\", \"#e7298a\", \"#e6ab02\")\nstates_pal_2 <- c(states_pal, \"black\")\nstates <- tar_read(states, store = file.path(\"targets_outputs\", \"_model_running_TAS\"))\nstates_ord <- c(\"NTE\", \"QLD\", \"NSW\", \"SAU\", \"TAS\", \"VIC\", \"WAN\", \"WAS\")\nstates_lng <- c(\"Northern Territory\", \"Queensland\", \"New South Wales\", \"South Australia\", \"Tasmania\", \"Victoria\", \"Western Australia (N)\", \"Western Australia (S)\")\n```\n:::\n\n\n\n# Methods {#sec-methods}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden  code-summary=\"Load in all the BARRA2 cells being used, with their coordinates.\"}\ncell_coords <- tar_read(BARRA_C2_cell_coords, store = file.path(\"targets_outputs\", \"_model_running_TAS\")) %>% \n  mutate(state = factor(state, levels = states_ord))\n\ntotals <- cell_coords %>% \n  group_by(state) %>% \n  reframe(cells = n())\n```\n:::\n\n\n\nThere were a total of 95418 cells used in this analysis: \n5045 in Victoria, \n5480 in New South Wales, \n21956 in Queensland, \n11451 in South Australia, \n29062 in Western Australia (divided into \n13794 cells in the north and \n15268 in the south), \n10185 in Tasmania, and \n12239 in the Northern Territory. \n\n\n\n::: {#cell-fig-states-map .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot(cell_coords, aes(x = longitude, y = latitude, fill = state)) +\n  geom_raster() +\n  geom_sf(data = ozmap_data(data = \"states\"), inherit.aes = F) +\n  coord_sf(xlim = c(bounds[[\"AUS\"]][\"lonmin\"], bounds[[\"AUS\"]][\"lonmax\"]),\n           ylim = c(bounds[[\"AUS\"]][\"latmin\"], bounds[[\"AUS\"]][\"latmax\"])) +\n  scale_x_continuous(breaks = seq(100, 160, 5)) +\n  scale_y_continuous(breaks = seq(-5, -45, -5)) +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_fill_brewer(palette = \"Dark2\") +\n  labs(x = \"Longitude\", y = \"Latitude\") +\n  prettyplot +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output-display}\n![Map showing the area included this analysis, with colours indicating the different states. The ~60 km coastline buffer includes 11,709 cells approximately 12 x 12 km each.\n](manuscript_files/figure-html/fig-states-map-1.png){#fig-states-map fig-align='center' width=768}\n:::\n:::\n\n\n\n## Environmental inputs {#sec-envinputs}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\ncell_input_files <- file.path(cell_data) %>% \n  list.files(full.names = T) %>% \n  str_subset(\"cell_input_timeseries\")\n  \ncell_input_timeseries <- list()\nfor (i in seq_along(cell_input_files)) {\n  cell_input_timeseries[[i]] <- cell_input_files[i] %>% \n    read_parquet()\n}\ncell_input_timeseries <- cell_input_timeseries %>% \n  bind_rows() %>% \n  mutate(state = factor(state, levels = states_ord))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nT_input <- cell_input_timeseries %>% \n  select(cell_no, state, yday, T_input)\n\nT_input %>% \n  group_by(state) %>% \n  reframe(mean = mean(T_input, na.rm = T),\n          max = max(T_input, na.rm = T),\n          min = min(T_input, na.rm = T))\n```\n:::\n\n::: {#cell-fig-T-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# # This averages over time and space to create a \"typical year\" per state - for plotting\n# T_input_state_av <- file.path(cell_data, \"T_input_state_av.parquet\") %>% \n#   read_parquet() %>% \n#   mutate(state = factor(state, levels = states_ord, labels = states_lng))\n# \n# p_input_state_av <- T_input_state_av %>% \n#   ggplot(aes(x = yday, y = value, ymin = value-sd, ymax = value+sd, colour = state, fill = state)) + \n#   geom_line(linewidth = 0.75) +\n#   geom_ribbon(alpha = 0.35, linewidth = 0.25) +\n#   facet_wrap(facets = vars(state), ncol = 2) +\n#   scale_y_continuous(breaks = seq(0, 40, 5), limits = c(10, 35))\n#   scale_fill_brewer(palette = \"Dark2\") +\n#   scale_color_brewer(palette = \"Dark2\") +\n#   env_plot +\n#   labs(x = \"Day of the year\", y = expression(\"Temperature (\"*degree*\"C)\"))\n# \n# p_input_state_av\n\nggplot()\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nI_input <- cell_input_timeseries %>% \n  select(cell_no, state, yday, I_input)\n\nI_input %>% \n  group_by(state) %>% \n  reframe(mean = mean(I_input, na.rm = T),\n          max = max(I_input, na.rm = T),\n          min = min(I_input, na.rm = T))\n```\n:::\n\n::: {#cell-fig-I-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# This averages over time and space to create a \"typical year\" per state - for plotting\nI_input_state_av <- file.path(cell_data, \"I_input_state_av.parquet\") %>% \n  read_parquet() %>% \n  mutate(state = factor(state, levels = states_ord, labels = states_lng))\n\np_input_state_av %+% I_input_state_av +\n  scale_y_continuous(breaks = seq(0, 1600, 200), limits = c(0,800)) +\n  labs(x = \"Day of the year\", y = expression(\"Irradiance (photons m\"^-2*\" s\"^-1*\")\")) \n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nS_input_cell_av <- file.path(cell_data, \"S_input_cell_av.parquet\") %>% read_parquet() # For gif making\nS_input_cell_av_depth <- file.path(cell_data, \"S_input_cell_av_depth.parquet\") %>% read_parquet()\n\ntest_deps <- S_input_cell_av_depth %>% \n  group_by(state, yday, dep) %>% \n  reframe(#sd = sd(value, na.rm = T),\n          value = mean(value, na.rm = T)) %>% \n  pivot_wider(names_from = dep, values_from = value, names_prefix = \"dep_\") %>% \n  mutate(diff1 = abs(dep_2.5-dep_7.5),\n         diff2 = abs(dep_12.5-dep_7.5),\n         diff3 = abs(dep_12.5-dep_2.5),\n         min_diff = min(c(diff1, diff2, diff3)),\n         max_diff = max(c(diff1, diff2, diff3)))\n\nS_input_cell_av <- S_input_cell_av %>% \n  group_by(state) %>% \n  reframe(mean = mean(value, na.rm = T),\n          max = max(value, na.rm = T),\n          min = min(value, na.rm = T))\n```\n:::\n\n::: {#cell-fig-S-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# This averages over time and space to create a \"typical year\" per state - for plotting\nS_input_state_av <- file.path(cell_data, \"S_input_state_av.parquet\") %>% \n  read_parquet() %>% \n  mutate(state = factor(state, levels = states_ord, labels = states_lng))\n\np_input_state_av %+% S_input_state_av +\n  scale_y_continuous(breaks = seq(30, 40, 0.25), limits = c(34.5, 35.5)) +\n  labs(x = \"Day of the year\", y = expression(\"Salinity (g L\"^-1*\")\"))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nUV_input_cell_av <- file.path(cell_data, \"UV_input_cell_av.parquet\") %>% read_parquet() # For gif making\nUV_input_cell_av_depth <- file.path(cell_data, \"UV_input_cell_av_depth.parquet\") %>% read_parquet()\n\ntest_deps <- UV_input_cell_av_depth %>% \n  group_by(state, yday, dep) %>% \n  reframe(#sd = sd(value, na.rm = T),\n          value = mean(value, na.rm = T)) %>% \n  pivot_wider(names_from = dep, values_from = value, names_prefix = \"dep_\") %>% \n  mutate(diff1 = abs(dep_2.5-dep_7.5),\n         diff2 = abs(dep_12.5-dep_7.5),\n         diff3 = abs(dep_12.5-dep_2.5),\n         min_diff = min(c(diff1, diff2, diff3)),\n         max_diff = max(c(diff1, diff2, diff3)))\n\n# print(\"Testing deps: min, max\")\n# min(test_deps$min_diff)\n# max(test_deps$max_diff)\n\nUV_input_cell_av <- UV_input_cell_av %>% \n  group_by(state) %>% \n  reframe(mean = mean(value, na.rm = T),\n          max = max(value, na.rm = T),\n          min = min(value, na.rm = T))\n```\n:::\n\n\n\nWater velocity (‘ocean_u’ and ‘ocean_v’) data were sourced from the \\acr{BRAN} data suite for 2019-2023 [@chamberlain_multiscale_2021; @oke_towards_2013; @oke_bluelink_2008]. Water velocity ($\\overline{UV} = \\sqrt{U^2+V^2}$) showed minimal differences between surface layers and was also depth-averaged over depths < 25 m. Data were very consistent among states but with considerable variation among cells (@fig-UV-input). All states shared similar mean daily values of \n0.13 m s$^{-1}$. Highest daily values were \n0.32 m s$^{-1}$ in southern Western Australia, and minimum daily value was \n0.037 m s$^{-1}$ in Queensland.\n\n\n\n::: {#cell-fig-UV-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# This averages over time and space to create a \"typical year\" per state - for plotting\nUV_input_state_av <- file.path(cell_data, \"UV_input_state_av.parquet\") %>% \n  read_parquet() %>% \n  mutate(state = factor(state, levels = states_ord, labels = states_lng))\n\np_I_input_state_av %+% UV_input_state_av +\n  scale_y_continuous(breaks = seq(0, 0.50, 0.1), limits = c(-0.01, 0.25)) +\n  labs(x = \"Day of the year\", y = expression(\"Water velocity (m s\"^-1*\")\"))\n```\n:::\n\n\n\n## Nitrogen {#sec-nitrogen}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# Sys.setenv(TAR_PROJECT = \"project_spatial_cells\")\n# tar_manifest()$name %>% unique() %>% str_subset(\"refstation\") %>% sort()\n\noutfall_locations <- tar_read(outfall_locations, store = cell_store) %>% \n  mutate(state = case_when(\n    lon > bounds[[\"NTE\"]][\"lonmin\"] & lon <= bounds[[\"NTE\"]][\"lonmax\"] & lat > bounds[[\"NTE\"]][\"latmin\"] & lat <= bounds[[\"NTE\"]][\"latmax\"] ~ \"NTE\",\n    lon > bounds[[\"QLD\"]][\"lonmin\"] & lon <= bounds[[\"QLD\"]][\"lonmax\"] & lat > bounds[[\"QLD\"]][\"latmin\"] & lat <= bounds[[\"QLD\"]][\"latmax\"] ~ \"QLD\",\n    lon > bounds[[\"NSW\"]][\"lonmin\"] & lon <= bounds[[\"NSW\"]][\"lonmax\"] & lat > bounds[[\"NSW\"]][\"latmin\"] & lat <= bounds[[\"NSW\"]][\"latmax\"] ~ \"NSW\",\n    lon > bounds[[\"SAU\"]][\"lonmin\"] & lon <= bounds[[\"SAU\"]][\"lonmax\"] & lat > bounds[[\"SAU\"]][\"latmin\"] & lat <= bounds[[\"SAU\"]][\"latmax\"] ~ \"SAU\",\n    lon > bounds[[\"TAS\"]][\"lonmin\"] & lon <= bounds[[\"TAS\"]][\"lonmax\"] & lat > bounds[[\"TAS\"]][\"latmin\"] & lat <= bounds[[\"TAS\"]][\"latmax\"] ~ \"TAS\",\n    lon > bounds[[\"VIC\"]][\"lonmin\"] & lon <= bounds[[\"VIC\"]][\"lonmax\"] & lat > bounds[[\"VIC\"]][\"latmin\"] & lat <= bounds[[\"VIC\"]][\"latmax\"] ~ \"VIC\",\n    lon > bounds[[\"WAN\"]][\"lonmin\"] & lon <= bounds[[\"WAN\"]][\"lonmax\"] & lat > bounds[[\"WAN\"]][\"latmin\"] & lat <= bounds[[\"WAN\"]][\"latmax\"] ~ \"WAN\",\n    lon > bounds[[\"WAS\"]][\"lonmin\"] & lon <= bounds[[\"WAS\"]][\"lonmax\"] & lat > bounds[[\"WAS\"]][\"latmin\"] & lat <= bounds[[\"WAS\"]][\"latmax\"] ~ \"WAS\"\n    )) %>% \n  mutate(state = factor(state, levels = states_ord)) %>% \n  select(-cell_ID)\n\nrefstation_locations <- tar_read(refstation_coords, store = cell_store) %>% \n  mutate(state = NA) %>% \n  rename(name = StationName) %>% \n  relocate(state, .before = name) %>% \n  select(-code)\n\noutfalls <- outfall_locations %>% \n  group_by(state) %>% \n  reframe(outfalls = n())\n\nN_locations <- rbind(\n  outfall_locations %>% mutate(type = \"outfall\"),\n  refstation_locations %>% mutate(type = \"refstation\")\n)\n```\n:::\n\n\n\n::: {note}\nRevise this section\n::: \nNitrogen inputs (in the form of nitrate and ammonium) are the least precise and most important inputs in the model. This study used the combined biogeochemical parameters taken at the \\acr{IMOS} reference stations \n::: {note}\nIMOS 2023 reference?\n::: \nas a primary source, and supplementary nitrogen data were sourced from the \\acr{NOD}\n::: {note}\nNOD 2025 reference?\n::: \n. Each cell was matched to its nearest \\acr{IMOS} reference station as a nutrient baseline, while outfalls were matched to multiple cells within a 48 km radius and their influence was considered inversely proportional to the distance between the cell centre and the outfall. @fig-N-data-locations shows the location and distribution of reference stations and outfall recordings. \n\n\n\n::: {#cell-fig-N-data-locations .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# ggplot(N_locations, aes(x = lon, y = lat, color = state, shape = type)) +\n#   geom_sf(data = ozmap_data(data = \"states\"), inherit.aes = F) +\n#   coord_sf(xlim = c(bounds[[\"AUS\"]][\"lonmin\"], bounds[[\"AUS\"]][\"lonmax\"]),\n#            ylim = c(bounds[[\"AUS\"]][\"latmin\"], bounds[[\"AUS\"]][\"latmax\"])) +\n#   geom_point(size = 3.5) +\n#   scale_shape_manual(values = c(20, 8)) +\n#   # scale_colour_manual(values = states_pal, labels = states_lng, na.value = \"black\") +\n#   scale_color_brewer(palette = \"Dark2\") +\n#   scale_x_continuous(breaks = seq(100, 160, 5)) +\n#   scale_y_continuous(breaks = seq(-5, -45, -5)) +\n#   labs(x = \"Longitude\", y = \"Latitude\") +\n#   prettyplot +\n#   theme(legend.position = \"none\")\n\nggplot()\n```\n:::\n\n\n\nData from the \\acr{IMOS} reference stations at Bonney Coast, Esperance and Ningaloo were too sporadic to be useful and their datasets were very similar to their closest neighbour stations, so their data were excluded. This left stations at Darwin, Maria Island, North Stradbroke Island, Port Hacking, Rottnest Island and Yongala for the current analysis. \n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\nMatching model cells to their nearest reference station resulted in \n2703 cells being matched to Darwin, \n1700 to Kangaroo Island, \n1739 to Maria Island, \n699 to North Stradbroke Island, \n641 to Port Hacking, \n2292 to Rottnest Island, and \n1903 to Yongala.\n\nOutfall data from \\acr{NOD} are only recorded as monthly observations of the water being added to coastal conditions, rather than ambient conditions in coastal waters. Data from outfall stations was only included if $\\geq$ 20 observations were made within the past 10 years (2014-2023). If $\\geq$ 20 observations were made from the period of 2019-2023, then the data were restricted to that period. One outfall station was fully excluded (Pardoe, in northern Tasmania) as the concentrations recorded were ~6 orders of magnitude higher than any other station and it was presumed that this was a data reporting error. While there is at least one outfall in each state, they are much more abundant in Victoria, Tasmania, New South Wales and Queensland. \nThere were \n7 outfall stations in South Australia, \n9 in southern Western Australia, \n4 in the Northern Territory, and \n1 in northern Western Australia. \nThese two nutrient data sources were combined into a single “typical” year for each nutrient, with outfall data being additionally weighted by the total volume of water recorded from the outfall location relative to a cell’s volume of surface water (12 km $\\times$ 12 km $\\times$ 10 m). Finally, a small degree of random variation (up to $\\pm$10% of standard deviation from the mean) was added to daily values of nitrate and ammonium. This was done to better reflect the high degree of variability generally recorded in nitrate and ammonium levels, forcing the macroalgae in the model to contend with some instability in its nutrient supply. @fig-example-N-input shows an example of the final nitrate and ammonium concentrations driving the growth model in a single cell, located in New South Wales.\n\n\n\n::: {#cell-fig-example-N-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\n# day15 <- data.frame(month = 1:12, day = rep(15, 12)) %>% \n#   mutate(yday = yday(make_date(year = 2023, month = month, day = day)))\n# \n# tar_read(refstation_cell_match, branches = 9500, store = cell_store)\n# tar_read(outfall_sites_cellpaired, branches = 9500, store = cell_store)\n# \n# Ni_data_prioritised <- tar_read(Ni_data_prioritised, store = cell_store, branches = 9500) %>% \n#   mutate(source = case_when(yday %in% day15$yday ~ \"outfall\", TRUE ~ \"refstation\"),\n#          form = \"1\") %>% \n#   merge(cell_coords, by = \"cell_ID\")\n# Am_data_prioritised <- tar_read(Am_data_prioritised, store = cell_store, branches = 9500) %>% \n#   mutate(source = case_when(yday %in% day15$yday ~ \"outfall\", TRUE ~ \"refstation\"),\n#          form = \"2\") %>% \n#   merge(cell_coords, by = \"cell_ID\")\n# \n# df <- rbind(Ni_data_prioritised, Am_data_prioritised) %>% \n#   mutate(data_value = set_units(data_value, \"mg m$^{-3}$\"),\n#          data_value = set_units(data_value, \"umol L-1\"),\n#          data_value = drop_units(data_value),\n#          value = set_units(value, \"mg m$^{-3}$\"),\n#          value = set_units(value, \"umol L-1\"),\n#          value = drop_units(value))\n# unique(df$state)\n# unique(df$cell_ID)\n# \n# ggplot(df, aes(x = yday, y = data_value, color = as.factor(source))) +\n#   geom_point() +\n#   facet_wrap(facets = vars(form), nrow = 2) +\n#   geom_line(aes(x = yday, y = value), inherit.aes = F) +\n#   scale_color_manual(values = c(\"orange\", \"steelblue\")) +\n#   scale_y_continuous(limits = c(0, 3.5), breaks = seq(0, 4, 0.5)) +\n#   env_plot +\n#   theme(strip.text = element_blank()) +\n#   labs(x = \"Day of the year\", y = nitrogen_lab)\n\nggplot()\n```\n:::\n\n\n\nConcentrations of both nitrate (@fig-Ni-input) and ammonium (@fig-Am-input) were very low relative to concentrations in coastal waters of other continents, which is expected for Australian coastal waters. However, nitrate around Victoria and Tasmania showed a peak in the middle of the year which was not observed in cells in other states, driven by readings from the BOM reference station located at Maria Island off the east coast of Tasmania. \n\n\n\n::: {#cell-fig-Ni-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n\n\nAmmonium concentrations were also low relative to global levels (@fig-Am-input) and generally at least one order of magnitude lower than nitrate but showed greater variability than nitrate. There were no obvious seasonal trends in ammonium, although variability between cells was generally higher than nitrate.\n\n\n\n::: {#cell-fig-Am-input .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n\n\n## Sensitivity conditions\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nculture_depths <- tar_read(culture_depths, store = spec_store)\nfactors <- tar_read(factors, store = spec_store)\n```\n:::\n\n\n\nSensitivity runs started on the first of every month to cover annual variability, for 12 runs per year, with the same mean annual conditions looping from December to January. Sensitivity runs were conducted at culture depths of 0.5 m, 2 m, 3.5 m, and 5 m below the surface with a light attenuation coefficient of 0.65 (clear water). The canopy was always 2.5 m in height, and the total water column depth was always 50 m.\nCurves for temperature, surface irradiance, salinity, water velocity, nitrate and ammonium were constructed to capture “typical” conditions based on daily means of each state from 2019-2023. This resulted in two sensitivity curves for temperature (@fig-state-temperature) and a single sensitivity curve for irradiance (@fig-state-irradiance), water velocity (@fig-state-water-velocity), salinity (@fig-state-salinity), nitrate (@fig-state-nitrate) and ammonium (@fig-state-ammonium).\n\n\n\n::: {#cell-fig-state-temperature .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n::: {#cell-fig-state-irradiance .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n::: {#cell-fig-state-water-velocity .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n::: {#cell-fig-state-salinity .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n\n\nBoth nitrate and ammonium are naturally low in Australian coastal waters and this is reflected in the sensitivity analysis (Figure 14). Despite this, the sensitivity curves for nutrients were constructed to encompass a relatively large level of variability. The “typical” ammonium concentration tested was slightly higher than actual reference levels, as it’s suspected that total N removed will be very sensitive to changes in parameters related to ammonium uptake.\n\n\n\n::: {#cell-fig-state-nitrate .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n::: {#cell-fig-state-ammonium .cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\nggplot()\n```\n:::\n\n\n\n## Growth and bioremediation\n### Growth limitations\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code .hidden}\ntar_read(init_biomass_PL)\ntar_read(init_state_PL)\ntar_read(Kd_PL)\n```\n:::\n\n\n\nThe model is constructed of several functions that individually limit growth based on discreet drivers (light, nutrients, temp., salinity). In the model these functions are combined in a multiplicative relationship. However, each function can be visualised individually to show its impact on growth, in this case we ignore nonlinear interactions between models.. Running these portions of the model across all cells can therefore help determine why a specific area is or is not suitable for seaweed growth and bioremediation. \n\nOf the model’s components, light and temperature limitation were expected to have the largest impact on species’ growth and bioremediation potential. Temperature limitation depends only on a species’ temperature tolerance and so was run with no biomass specifications. Light limitation depends primarily on PAR availability at culture depth, although biomass-dependent self-shading also has a small impact. Light limitation was run at 0.5 m depth (with a canopy of 5 m) for all species using a very small starting biomass (0.005 g L$^{-1}$) to keep self-shading to a minimum. \n\n### Total growth and bioremediation\nThe growth and removal model in its entirety was run for both species (*Asparagopsis armata* and *Asparagopsis taxiformis*) in all cells. The total nitrogen removed was calculated as the difference between total tissue nitrogen (N_f+N_s) at harvest and out-planting. \n\n## Growth scenarios\nThe gridded environmental inputs fed into the model will not cover the full range of potential conditions that a seaweed farm might experience. Therefore, we describe “growth scenarios” to encompass some of the variation for comparison (@tbl-scenario-modifications). Temperature and salinity have both been varied by 10% in relevant scenarios. Rather than varying light directly, the light attenuation coefficient (kW) has been varied by 10% to simulate clearer or more cloudy water. Water velocity has been varied by a factor of 4 in each direction to simulate stagnant and exposed waters. Nitrate and ammonium have been modified using fixed additions to their values to match more closely with measured conditions. \n\nThese scenarios were run for each state’s typical conditions and the difference in total N removed and proportional N compared to the “base” scenario, which used state average environmental conditions and a water depth of 50 m. \n\n|------|------|------|------|------|------|------|------|\n| Scenario name | DEPTH (M) | TEMPERATURE | kW           | SALINITY         | WATER VELOCITY  | NITRATE   | AMMONIUM  |\nFISH FARM       | 30        |             |              |                  |                 | +3.5 µM   | +6.5 µM   |\nDEEP WATER      | 100       | $\\times$0.9 | $\\times$1.1  |                  | $\\times$4       |           |           |\nSHALLOW BAY     | 15        | $\\times$1.1 | $\\times$0.9  | $\\times$1.1      | $\\times$0.25\t  | +3.5 µM   |           |\nESTUARY MOUTH   | 30        |             | $\\times$0.9  | $\\times$0.9      |                 | +3.5 µM\t  |           |\n: Summary of modifications made to state average values for each growth scenario. Blank cells indicate that no changes were made to state average values. {#tbl-scenario-modifications}\n\n## Statistical analysis & code availability\nAll model running, data handling and analysis were conducted in R version 4.4.2 “Pile of Leaves” (R Core Team, 2024). The custom package “macrogrow” (available on Github) was used to run the seaweed growth modelling portions of this analysis. All other packages used are listed in the Github repository.\n\n# Results \n## Species parameterisation \n\nAll species parameters are summarised in Table 2. Parameters for *Asparagopsis armata* and *A. taxiformis* were sourced from studies performed on the individual species where possible, but this was complicated by the limited data available. While *Asparagopsis* is native to Australia, it has been more extensively studied in its invasive range in the northeastern Atlantic and the Mediterranean. Additionally, most *Asparagopsis* studies focus on the tetrasporophyte lifestage (which is easier to cultivate in the lab) but the grow-out phase in oceanic seaweed culture is the gametophyte. Parameters sourced from tetrasporophyte studies but used here for gametophyte growth include the ammonium uptake parameters V_am and K_am, the nitrate uptake parameters M_ni and C_ni, the light response parameter I_o and the temperature response parameters T_opt, T_min,and  T_max. There was no information available to parameterise the salinity tolerance of *Asparagopsis*. This study instead used typical Australian conditions to define “optimum” salinity and gave the species a tolerance range 50% narrower than the range of Ecklonia.\n\nTable 2: Parameters defined for use in the growth model for *Asparagopsis armata*, *Asparagopsis taxiformis*. Note that *A. taxiformis* shares all parameters with *A. armata* except those relating to temperature. Parameters not relevant to a species are left blank.\n\nModelled species temperature responses (Figure 16) are likely to be very impactful on overall species growth. *Asparagopsis armata* is better-suited to cold water, while *Asparagopsis taxiformis* has a narrower temperature tolerance range than the other species but is better-suited to higher temperatures.\n\nFigure 16: Temperature response of *Asparagopsis armata* (red), *Asparagopsis taxiformis* (pink).\n\nModelled light responses (Figure 17) shows variation between species, but also in the same species grown at different depths. *Asparagopsis* does very well in shallow waters and low-light situations.\n\nFigure 17: Simulated light response of *Asparagopsis* (red) when grown at depths of 0.5 m (solid), 2 m (dashed), 3.5 m (dot-dashed) or 5 m (dotted).\n\nThe modelled response of the different species to changes in salinity (Figure 18) showed similar trends to their temperature responses. *Asparagopsis* had similar optimum salinities.\n\nFigure 18: Salinity response of *Asparagopsis* (red).\n\nModelled responses to nitrate and ammonium were very different between species (Figure 19). Like most seaweeds, the species studied here prefer ammonia to nitrate. *Asparagopsis* only takes up nitrate at a low, constant rate (Table 2). This is potentially very important, as nitrate is generally the dominant form of nitrogen in Australian coastal waters.\n\nFigure 19: Uptake rate of nitrate (solid) and ammonium (dashed) by *Asparagopsis* (red).\n\n### Parameter sensitivity\n\nDue to physiological differences, the same out-planted biomass (0.005 g L$^{-1}$) and internal relative nutrient quotient (0.5) for each species in the sensitivity runs equated to different starting N_f values: 97.16 mg m−3 for both *Asparagopsis* species.\n\nBoth *A. armata* and *A. taxiformis* were most sensitive to changes in parameters controlling their internal nutrient quotient (Q_min and Q_max). This is as expected, as narrowing the possible bounds of the macroalgae internal nutrient reserves decreased the total nitrogen removed, and *Asparagopsis* additionally has a higher minimum internal nutrient quotient requirement than the other species. For more detailed parameter sensitivities, see Appendix section: Species parameter sensitivity.\n\n## Growth and bioremediation\n### Temperature limitation\n\nRelative temperature limitation on each species’ growth (T_lim) varied both spatially and temporally. - summarise the temporal trends across a typical year in each state, and - show the cells across Australia that maintained “good” growing temperatures by indicating how many consecutive days in a typical year where T_lim$\\geq$0.75. While this value is arbitrary, it provides a consistent reference point for comparing spatial and temporal patterns in growth conditions across regions. Unsurprisingly, the Northern Territory, Queensland and northern Western Australia were almost entirely too warm for the temperate *A. armata*. Tasmania had some of the strongest seasonal variation in temperature limitation, with most of the state providing good conditions from late December to late April (Figure 21). While cells on the east coast of Tasmania were slightly better suited to *A. armata* growth, the state showed little spatial variation overall. New South Wales also showed strong seasonal variation in temperature limitation, showing good growing temperatures for *A. armata* from mid-July to late October, and mostly in the lower half of the state (below ~32˚S).\n\nBy contrast, South Australia and southern Western Australia showed weak seasonal variation in temperature limitation but much higher spatial variation. The only area that appeared to have ideal temperature conditions for *A. armata* growth year-round was the area between Esperance and Albany in southern Western Australia (Figure 20). \n\nFigure 20: The maximum number of days where Tlim $\\geq$ 0.75 for *A. armata* in a typical year.\n\nFigure 21: Limitation of relative growth by temperature for *A. armata* across all cells in a typical year (mean $\\pm$ SD). \n\nWithin the model, the only difference between the two *Asparagopsis* species was their temperature response. Despite its higher temperature tolerance (see Figure 16) *A. taxiformis* seemed overall more limited by temperature than *A. armata* across Australia (Figure 23). The tropical species was mostly unable to grow below 33˚S on the west coast and 35˚S, and there was only a very small area off the central coast of Western Australia just outside of Shark Bay where temperature conditions were ideal for *A. taxiformis* year-round. \n\nFigure 22: The maximum number of days where Tlim $\\geq$ 0.75 for *A. taxiformis* in a typical year.\n\nFigure 23: Limitation of relative growth by temperature for *A. taxiformis* across all cells in a typical year (mean $\\pm$ SD).\n\n### Light limitation\n\nNone of the species studied here were sensitive to direct changes in their light-related parameters (Figures 51-54). Additionally, given the similar light responses of the different species (Figure 17) and the available surface irradiance mostly falling between 150-600 µmol photons m-2 s$^{-1}$ (Figure 3), all species were only grown at a depth of 0.5 m. The light attenuation coefficient kW was fixed at 0.6 (clear water) so the following represent light availability at an “optimum” depth.\n\n*Asparagopsis* (both *A. armata* and *A. taxiformis*) were best suited to high-light conditions, showing less limitation due to light availability at higher latitudes (Figure 28). There were very few days where I_lim dropped below 0.75 in the northern states, however in Tasmania and Victoria limitation due to light availability was consistently <0.75 from mid-April to early October and <0.5.from early May to early August (Figure 29).\n\nFigure 28: The maximum number of days where Ilim $\\geq$ 0.75 for *Asparagopsis* spp. in a typical year.\n\nFigure 29: Limitation of relative growth by changes in seasonal light availability for *Asparagopsis* spp. across all cells grown at 0.5 m depth in a typical year (mean $\\pm$ SD).\n\n### Total growth and bioremediation\n\nAfter running the model in all cells, there were 1034 cells (of 11677) where the run failed due to missing environmental data or the cell being too shallow to accommodate the 5.5 m canopy. Overall, nitrogen removal by *A. armata* and *A. taxiformis* was less than other species. \n\nNitrogen removal by *A. armata* was fairly consistent across a typical year in Tasmania with a mean of 204.0 g m-2 of farmed area, Victoria with a mean of 256.0 g m-2 of farmed area, and South Australia with a mean of 327.0 g m-2 of farmed area (Figure 34). The highest total removal across the year was also in South Australia. Nitrogen removal was most temporally variable in New South Wales, ranging from 8.5 g m-2 of farmed area to 540.0 g m-2 of farmed area, peaking when the simulated macroalgae was out-planted in August.\n\nFigure 34: Total nitrogen removed (mean $\\pm$ SD) by *A. armata* planted in different months across all cell in each state.\n \nNitrogen removal in South Australia was relatively spatially consistent, while the east coast of Australia showed greater variability (Figure 35). Some areas of Victoria on the borders of New South Wales and South Australia showed nitrogen removal comparable to the neighbouring state, likely reflecting the influence of data from the different reference stations. The potential “hotspot” area between Esperance and Albany in southern Western Australia, identified in temperature limitation maps above (see Figure 20), did not show higher nitrogen removal rates than the rest of the state. Similarly, Tasmania showed moderate nitrogen removal rates year-round (), despite the species being relatively limited by temperature from May to November (see Figure 21).\n\nFigure 35: Southern half of Australia showing the total nitrogen removed by *A. armata* planted in March (top) or August (bottom).\n\nNitrogen removal by *A. taxiformis* was highest in New South Wales, with a mean nitrogen removal rate of 304 g m-2 of farmed area in each month of outplanting (Figure 36). Nitrogen removal was less consistent across the year in South Australia (peaking at a mean of 158 g m-2 of farmed area in February), northern Western Australia (peaking at 143 g m-2 of farm in June) and the Northern Territory (peaking at 142 g m-2 of farmed area in June).\n\nFigure 36: Total nitrogen removed (mean $\\pm$ SD) by *A. taxiformis* planted in different months across all cell in each state. \n\nTotal nitrogen removal by *A. taxiformis* was relatively spatially consistent in most states except for Queensland, where the southern coast showed higher removal rates (Figure 37). This was likely driven by ambient nitrogen data, particularly the differences between reference stations (Figures 8 and 9). By contrast, the spatial variability seen in the north-west of the country (Figure 37) is more likely driven by temperature and light variability, given that there are fewer reference stations and outfall points (Figure 6).\n\nFigure 37: Total nitrogen removed by *A. taxiformis* planted in May in the Northern Territory and northern Western Australia (top), and in October in New South Wales and Queensland (bottom).\n\n## Growth scenarios\n\nWhen compared with the base scenario, all species were able to remove the most nitrogen in the fish farm scenario, almost certainly because of the increase in ammonium concentration from (very low) background levels (Figure 42). *Asparagopsis armata* and *A. taxiformis* consistently removed more nitrogen in the fish farm scenario.\n\nDifferences in nitrogen removed by *Asparagopsis* were minimal in the estuary mouth scenario across all states (ranging from -2.1% to +2.5% of base). Similarly, in the shallow bay scenario, *Asparagopsis* was able to remove from 0.4 to 9.5$\\times$ more nitrogen. The deep water scenario showed mostly negative but relatively small changes from the base removal, with changes ranging from -36% removal by *A. taxiformis* in New South Wales to +16.2% removed by *A. armata* in northern Western Australia. \n\nFigure 42: Nitrogen removal for different scenarios compared to the base scenario. Colours show the different scenarios as fish farm (purple), deep water (green), estuary mouth (orange) and shallow bay (pink).\n\n# Discussion {#sec-discussion}\n\nThis study demonstrates that seaweed aquaculture has significant bioremediation potential across Australia, with scenario modelling suggesting that *Asparagopsis* species can be effective at removing excess nitrogen from the environment. Across a range of conditions, these species showed nitrogen uptake potential that varied by region and season. Our model tested different pollution contexts, including marine aquaculture waste and estuarine runoff, highlighting the ability of seaweed cultivation to mitigate nutrient pollution.\n\nOur analysis highlighted variability in bioremediation potential among different macroalgae species under varying environmental conditions across Australia. The local availability of nitrogen, specifically ammonium and nitrate, emerged as the primary driver of this variability. Nitrate, generally in very low concentrations, is the predominant form of nitrogen in Australian coastal waters, which can be considered as oligotrophic (e.g. Chen et al., 2020; Pritchard et al., 2001; Twomey et al., 2007; Wild-Allen et al., 2010). This poses a clear challenge for the use of macroalgae for bioremediation in Australia. While all species studied showed higher uptake efficiency of ammonium, the low ambient levels of this compound limit their overall nitrogen uptake. Anthropogenic nutrient inputs, such as those from fish farms and sewage treatment outfalls, can create high nitrogen environments conducive to effective macroalgae cultivation and therefore bioremediation. The highest mean concentration of nitrate reported here from available data was 3.9 µM, and the fish farm scenario almost doubled this value (7.4 µM). While this is expected within Australian waters, it is still very low in a global context. For example, in Chile, mean coastal nitrate concentrations near salmon farms range from 3.2 µM in summer to 22.1 µM in winter (Varela et al., 2018). \n\nAll species studied here demonstrated a preference for ammonium uptake over nitrate, with *Asparagopsis armata* and *A. taxiformis* showing the highest uptake efficiency of ammonium. However, in the context of bioremediation, a species’ ability to take advantage of surges in nutrient concentrations is perhaps more important than its absolute uptake rate. By contrast, *Asparagopsis*, has a constant nitrate uptake rate which was minimally impacted by changes in nitrate concentrations. It is worth nothing that minimal seasonal variation in nutrient concentration was included in the present study. However, seasonal trends in ammonium and nitrate concentrations are often observed in coastal waters due to natural process (e.g. phytoplankton growth) and anthropogenic inputs (e.g. urban runoff from rainfall events).\n\nTemperature played a secondary role in influencing nitrogen uptake efficiency, generally reflecting the natural geographic ranges of the species. *Asparagopsis armata* showed the potential for year-round growth (indicating year-round nitrogen uptake) in cooler regions of Australia, reflecting its temperate to subtropical range and wide temperature tolerance. *Asparagopsis taxiformis* showed more restricted temperature ranges, limiting their bioremediation potential to specific regions and seasons. \n\nLight-related parameters did not appear to significantly influence the nitrogen uptake of any macroalgae species, possibly driven by the low resolution in the available light attenuation data. Given the similar light responses among species and the consistent surface irradiance among all regions, all species were only modelled as growing at a depth of 0.5 m and in uniformly clear water. This uniformity in light response and growth depth simplified the model, ensuring that light availability did not confound the results. There is, however, a clear need for accurate site-specific light attenuation data to assess the impact of depth on macroalgae growth, as light is crucial for photosynthesis and growth. Smart et al (2022) used a laboratory setting to examine the nitrogen uptake kinetics of four kelp species under different ammonium concentrations. The nitrogen uptake rate of all species varied seasonally, increasing with higher temperatures and light availability.\n\n*Asparagopsis* species are currently the most commercially valuable for cultivation than the other species studied here due to their use in reducing methane emissions from livestock. However, modelling revealed that, despite the high nitrogen tissue content of *Asparagopsis* spp., these species are significantly less efficient in nitrogen uptake. This inefficiency is likely due to their lower rates of nitrate uptake compared to the other species combined with Australia’s low nitrate waters, their high nitrogen tissue requirements, and their more narrow temperature tolerance. These assumptions, however, are largely based on research conducted in regions outside Australia (e.g. Torres et al., 2021; Zanolla et al., 2019). More Australian local-scale studies are necessary to better understand the nitrogen uptake kinetics of *Asparagopsis* spp. in Australian coastal waters. \n\nThe study’s methodology, which integrated reference station and outfall data, provided a broad overview of spatial and temporal variation in nutrient concentrations in Australian coastal waters, However, the actual impact of outfalls and other nutrient sources on nitrogen concentration is more complex and site-specific, often stratified by depth and influenced by local hydrodynamic conditions (Pritchard et al., 2001). This suggests that detailed knowledge of ammonium and nitrate concentrations at specific sites, along with species-specific uptake kinetics, is crucial for accurately assessing the bioremediation potential of macroalgae in different coastal environments. Furthermore, individual site conditions could provide valuable insights for growers on the suitability of particular species for cultivation. For example, while the present model captured some thalli degradation due to high water velocities, it did not include breakage off the lines due to high swells or storm events, which would have a greater impact on more fragile seaweeds like *Asparagopsis* spp.\n\nGiven *Asparagopsis* is the only genus studied here that currently has significant commercial value, future research should focus on identifying ‘hotspots’, considering temperature thresholds, time of year and placement, where *Asparagopsis* can thrive. Additionally, understanding the nitrogen uptake rate of the *Asparagopsis* gametophyte life stage, rather than assuming it is identical to the tetrasporophyte life stage, is essential for advancing open-water *Asparagopsis* culture for bioremediation. \n\nOverall, this study provides valuable insights into the bioremediation potential of native Australian macroalgae species, highlighting the importance of nitrogen availability and temperature in shaping their effectiveness. The findings highlight the need for species selection and consideration of site-specific conditions when integrating seaweed aquaculture for bioremediation in Australian waters. As the industry explores seaweed farming's role in coastal management, future research should focus on refining spatial models, incorporating finer-scale environmental data, and evaluating economic feasibility. With the right approach, seaweed farming could reduce water pollution, support sustainable aquaculture, and enhance coastal ecosystem health. This study lays the groundwork for guiding site selection and key considerations in expanding seaweed farming across Australia.\n\n# Acknowledgments\n\nThe project authors would like to thank Jens Knauer and Margie Rule of the \\acr{ASSA} for their input and expertise on *Asparagopsis** husbandry, and Professor Rocky de Nys for his feedback on study methodology. Data for this study were sourced from Australia’s \\acr{IMOS}, which is enabled by the \\acr{NCRIS}. Data were also sourced from the \\acr{NOD}. Work for \\acr{NOD} is undertaken for the Marine and Coastal Hub, a collaborative partnership supported through funding from the Australian Government's \\acr{NESP}.\n\n# References",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}